# 예외

[아이템 71. 필요 없는 검사 예외 사용은 피하라](#필요-없는-검사-예외-사용은-피하라)     
[- 정리](#정리)  

<br>

## 필요 없는 검사 예외 사용은 피하라
- 검사 예외는 발생한 문제를 프로그래머가 처리하여 안전성을 높이게끔 해준다.
- 하지만, 검사 예외를 과하게 사용하면 오히려 쓰기 불편한 API가 된다.
- 더구나 **검사 예외를 던지는 메서드는 스트림 안에서 직접 사용할 수 없기 때문에** 자바 8부터는 부담이 더욱 커켰다.
    

#### 검사 예외를 회피하는 방법
- 검사 예외를 회피하는 가장 쉬운 방법은 적절한 결과 타입을 담은 옵셔널을 반환하는 것이다.
  - 검사 예외를 던지는 대신 빈 옵셔널을 반환하면 된다.
  - 이 방식의 단점은 예외가 발생한 이유를 알려줄 수 없다는 점이다.

- 검사 예외를 던지는 메서드를 2개로 쪼개 비검사 예외로 바꿀 수 있다.
  - 검사 예외를 던지는 메서드 - 리팩터링 전
    ```java
    try {
      obj.action(args);
    } catch (TheCheckedException e) {
      ... // 예외 상황에 대처
    }
    ```
    
  - 상태 검사 메서드와 비검사 예외를 던지는 메서드 - 리팩터링 후
    ```java
    if (obj.actionPermitted(args)) {
        obj.action(args);
    } else {
        ...  // 예외 상황에 대처
    }
    ```
    - 이 리팩터링을 모든 상황에 적용할 수는 없다. 그래도 적용할 수 있다면 더 쓰기 편한 API를 제공할 수 있다.
    - 프로그래머가 이 메서드가 성공하리라는걸 안다거나, 실패 시 스레드를 중단하길 원한다면 한 줄로 작성해도 된다.  
      → `obj.action(args);` 
    - `actionPermitted`는 상태 검사 메서드에 해당하므로, 외부 동기화 없이 여러 스레드가 동시에 접근할 수 있거나 외부 요인에 의해 상태가 변할 수 있다면 이 리팩링은 적절하지 않다.
    - `actionPermitted`가 `action` 메서드의 작업 일부를 중복 수행한다면 성능에서 손해이니, 마찬가지로 이 리팩링은 적절하지 않다.

<br>
    
### 정리
- 꼭 필요한 곳에만 사용한다면 검사 예외는 프로그램의 안전성을 높여주지만, 남용하면 쓰기 고통스러운 API를 낳는다.
- 복구가 가능하고 호출자가 그 처리를 해주길 바란다면, 우선 옵셔널를 반환해도 될지 고민하자.
- 옵셔널만으로는 상황을 처리하기에 충분한 정보를 제공할 수 없을 때만 검사 예외를 사용하자.

<br>

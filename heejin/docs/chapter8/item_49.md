# 메서드

[아이템 49. 매개변수가 유효한지 검사하라](#매개변수가 유효한지 검사하라)  
[- 정리](#정리)  

<br>

## 매개변수가 유효한지 검사하라
- 오류는 가능한 한 빨리 (발생한 곳에서) 잡아야 한다.
- 메서드와 생성자의 입력 매개변수는 값이 특정 조건을 만족하는지 확인해야 한다.
  - eg. 인덱스 값은 음수이면 안되고, 객체 참조는 null이 아니어야 한다. 
- 매개변수 검사에 실패하면 실패 원자성을 어기는 결과를 낳을 수 있다. _(→ item76)_
  - 메서드가 수행되는 중간에 모호한 예외를 던지며 실패하는 경우
  - 메서드가 잘 수행되지만 잘못된 결과를 반환하는 경우
  - 메서드가 잘 수행되지만 객체를 이상한 상태로 만들어 놓아서 이후에 관련 없는 오류를 내는 경우


### 매개변수의 예외처리와 문서화
- public과 protected 메서드는 매개변수 값이 잘못됐을 때 던지는 예외를 문서화해야 한다.
  - `@throws` 자바독 태그를 사용한다.
- 보통은 IllegalArgumentException, IndexOutOfBoundsException, NullPointException 중 하나가 될 것이다. _(→ item72)_
- 클래스 수준의 주석은 그 클래스의 모든 public 메서드에 적용되므로 각 메서드에 일일이 기술하는 것보다 훨씬 깔끔한 방법이다.
  - [매개변수의 제약을 문서화한 예제](../../src/main/java/study/heejin/chapter8/item49/ParameterThrowsDoc.java)


### 매개변수 유효성 검사 방법
- 자바 7에서 추가된 java.util.Objects.requireNonNull 메서드는 유연하고 사용하기도 편하다.
  - `requireNonNull` 메서드를 사용하면 원하는 예외 메시지도 지정할 수 있다.
  - 또한, 입력을 그대로 반환하므로 값을 사용하는 동시에 null 검사를 수행할 수 있다.
- 자바 9에서 Objects에 범위 검사 기능도 추가되었다.
  - `checkFromIndexSize`, `checkFromToIndex`, `checkIndex` 메서드이다.
  - 하지만 예외 메시지를 지정할 수는 없다.
  - 또한, 닫힌 범위(closed range)는 다루지 못한다.
- `public`이 아닌 메서드라면 단언문(`assert`)을 사용해 매개변수 유효성을 검증할 수 있다.
  - [단언문을 사용한 도우미 메서드 예제]()
- 메서드가 직접 사용하지 않으나 나중에 쓰기 위해 저장하는 매개변수는 특히 더 신경 써서 검사해야 한다.
- **생성자 매개변수의 유효성 검사는 클래스 불변식을 어기는 객체가 만들어지지 않게 하는데 꼭 필요하다.**
- 유효성 검사 비용이 지나치게 높거나 혹은 계산 과정에서 암묵적으로 검사가 수행될 때는 메서드 실행 전에 유효성 검사를 하지 않아도 된다.
- 때로는 잘못된 매개변수 값을 사용해 발생한 예외와 API 문서에서 던지기로 한 예외가 다를 수 있다.
  - 이때는 예외 번역 관용구를 사용하여 API 문서에 기재된 예외로 번역해줘야 한다. _(→ item 73)_


### 정리
- 메서드나 생성자를 작성할 때, 그 매개변수들에 어떤 제약이 있을지 생각해야 한다.
- 그 제약들을 문서화하고 메서드 코드 시작 부분에서 명시적으로 검사해야 한다.


<br>

#### Reference
- [Using Java Assertions](https://www.baeldung.com/java-assert)
## item90 직렬화된 인스턴스 대신 직렬화 프록시 사용을 검토하라

### Serializable을 구현한 객체의 인스턴스 유효성을 지키기 위해 직렬화 프록시 패턴을 사용하자
- 직렬화 프록시 패턴를 사용해 구현된 클래스 `EnumSet`
- 중첩 클래스를 두어 바깥 클래스의 직렬화 프록시 역할을 한다
- 중첩 클래스의 생성자는 하나여야 하며 바깥 클래스의 매개변수로 받아야 한다
  - 이 생성자는 단순히 인수로 넘어온 인스턴스의 데이터를 복사한다
- 바깥 클래스의 writeReplace()
  - 자바 직렬화 시스템이 바깥 클래스의 인스턴스 대신 SerializationProxy 인서턴스를 반환하게 하는 역할을 한다
  - 직렬화가 이뤄지기 전에 바깥 클래스의 인스턴스를 직렬화 프록시로 변환해준다
  - 직렬화 시스템은 바깥 클래스의 직렬화된 인스턴스를 생성해낼 수 없다
- 바깥 클래스의 readObject() 
  - 직렬화 프록시 패턴용 readObject()
  - 불변식을 훼손하는 시도를 막을 수 있다 
- 내부 클래스의 readResolve()
  - 역직렬화 시 직렬화 시스템이 직렬화 프록시를 다시 바깥 클래스의 인스턴스로 변환하게 해준다
  

### EnumSet 클래스는 직렬화 프록시로 구현된 클래스이다

### 직렬화 프록시 패턴은 안전성이 있지만 방어적 복사 때보다 성능이 느리다


### 정리
- 제3자가 확장할 수 없는 클래스라면 가능한 한 직렬화 프록시 패턴을 사용하자
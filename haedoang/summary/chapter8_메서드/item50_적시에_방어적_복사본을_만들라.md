## item50 적시에 방어적 복사본을 만들라 

### 방어적 프로그래밍을 하라
- 클라이언트가 불변식을 깨뜨릴 수 있음을 염두에 두어야 한다
- `Date` 클래스는 불변식을 지키지 않는 클래스이기 때문에 사용에 주의하여야 한다
  - `LocalDateTime`, `ZonedDateTime` 은 방어본을 만들기 때문에 이것을 사용하도록 하자


### Date 객체를 통해 불변식을 방어하는 방법 
- 생성자에서 받은 가변 매개변수를 `방어적 복사(defensive copy)` 한다
  - 오브젝트 생성 이후 가변 매개변수 값의 변화로 불변식을 해치는 것을 방어할 수 있다
- 매개변수의 유효성을 검사하기 전에 방어적 복사본을 만들어서 유효성을 검사한다
- 매개변수가 제 3자에 의해 확장될 수 있는 타입이라면 방어적 복사본을 만들 때 clone을 사용하면 안된다
- 가변 필드의 방어적 복사본을 만들어야 한다
  - 접근자를 통해 가변 필드를 변경하는 경우 불변식을 해칠 수 있다

### LocalDateTime
- java8 부터 지원하는 클래스로 위와 `Date` 클래스의 단점을 보완했다


### 정리
- 클래스가 클라이언트로 반환하는 가변이라면 요소에 대해 방어적 복사를 하여 불변성을 보장하여야 한다
- 복사 비용이 큰 경우 클라이언트를 신뢰할 수 있는 경우 방어적 복사를 수행하는 대신 구성 요소 변경에 대한 책임을 클라이언트에게 있음을 문서화하자

